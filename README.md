# Typed AST Module
This module is a fork of CPython 3.5's AST module with the ability to parse 
[PEP 484](https://www.python.org/dev/peps/pep-0484/) type comments.  The primary
goals of this module are correctness and speed.  This project is still a work in
progress, but is being actively developed.

### Current Caveats for Use
- The module may not compile correctly on Python versions other than 3.5.1.
  (Further testing and robustness fixes are in active development.)
- Type comments in invalid locations produce syntax errors.
- The matching of type comments is space sensitive.  They will only be matched
  if they begin with exactly `# type: `, including the space after the colon.

## Development Notes
### General Notes
- token names in `Python.asdl` need to match token names both in `tokenizer.c`
  AND in `pgen`'s copy of `tokenizer.c`.

### Rebuilding Autogenerated Files
- After changing `Parser/Python.asdl`, you must run:
 - `python3 Parser/asdl_c.py -h Include/ Parser/Python.asdl`
 - `python3 Parser/asdl_c.py -c Python/ Parser/Python.asdl`
- After changing `Grammar/Grammar`, you must run:
  - `pgen Grammar/Grammar Include/graminit.h Python/graminit.c`
- To get a working `pgen` binary: (this is hacky and will be changed)
 - get a clean copy of Python 3.5.1
 - overwrite `Include/token.h`, `Include/compile.h`, and `Parser/tokenizer.c`
 with the versions from typed\_ast
 - In the Python directory, run: `./configure && make`
 - `Parser/pgen` (in the Python directory) can now be used to regenerate
 typed\_ast's graminit files.

### TODO
- [ ] stop aliasing the official Python headers
- [ ] ensure we're not using duplicate versions of important standard library
  functions (like object creation)
- [ ] hide most global symbols from being exported to prevent conflicts with other
  libraries
- [ ] allow type ignores to be followed by a comment
- [ ] prevent type comments in incorrect locations from causing syntax errors
- [ ] find a better way to compile pgen
- [ ] check compatibility with older Python versions
 - [ ] Python 3.4
 - [ ] Python 3.3
 - [ ] Python 3.2
- [ ] parse Python 2.7 ASTs
